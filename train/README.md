# Train

This folder contains the training scripts & configs. Preconditions are assumed!

We'll train an **XGBoost** model for predicting interest rate hikes/cuts, and a **DeepAR** models for everything else.

Note that the predictions for commodities won't be as strong, as they're affected by factors that aren't directly numeric, as discussed in the `data` folder [README](../data/README.md).

## File Structure

This folder contains the following important files:

```md
├── deep.py           # DeepAR model definition
├── xg.py             # XGBoost model definition
├── train_deepar.py   # Script for training DeepAR models
└── train_xgboost.py  # Script for training XGBoost models
```

## Miscellaneous Notes

### DeepAR

- The DeepAR model will return a probability distribution. This is especially nice for making quantile-based predictions and going extra risky/conservative based on your risk tolerance. It will give lots of data for making a decision.
- Once the DeepAR model is trained, when making inferences, we don't actually need as long of a history window as we do for training. For example, we could just go with the past 10 days instead of the past 5 years. This'll speed up inferences significantly.

### XGBoost

We'll be using Focal Loss for handling class imbalance, since hikes/cuts are much rarer than holds.

## Outputs

- Training scripts:
  - Import features generated by `core/features.py`
  - Align targets for the chosen prediction horizon
  - Fit interest rates / models using XGBoost with quantile loss
    - SMOTE to handle class imbalance (since usually we hold rates steady)
  - Save trained artifacts in `models/`

All scripts are designed to be reusable across assets and quantiles.
